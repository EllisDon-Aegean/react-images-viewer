!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("prop-types"),require("react"),require("aphrodite/no-important"),require("styled-components"),require("aphrodite"),require("react-scrolllock")):"function"==typeof define&&define.amd?define(["prop-types","react","aphrodite/no-important","styled-components","aphrodite","react-scrolllock"],t):e.ImgsViewer=t(e.PropTypes,e.React,e.aphrodite,e["styled-components"],e.aphrodite,e.ScrollLock)}(this,function(e,t,n,r,o,i){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var a="default"in t?t.default:t;r=r&&r.hasOwnProperty("default")?r.default:r,i=i&&i.hasOwnProperty("default")?i.default:i;var l={container:{background:"rgba(0, 0, 0, .8)",gutter:{horizontal:10,vertical:10},zIndex:2001},header:{height:40,font:"Arial"},close:{fill:"white"},footer:{color:"#fff",count:{color:"rgba(255, 255, 255, .75)",fontSize:".85em"},height:40,gutter:{horizontal:0,vertical:5},font:"Arial"},thumbnail:{activeBorderColor:"#fff",size:50,gutter:2},arrow:{background:"none",fill:"#fff",height:120}},s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},d=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},f=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},m=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))};function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},t);return Object.keys(e).forEach(function(r){"object"===s(e[r])&&e[r]&&t[r]?n[r]=g(t[r],e[r]):n[r]=e[r]}),n}var v=!("undefined"==typeof window||!window.document||!window.document.createElement);var b={arrowLeft:function(e){return'<svg fill="'+e+'" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 512 512" xml:space="preserve">\n\t\t<path d="M213.7,256L213.7,256L213.7,256L380.9,81.9c4.2-4.3,4.1-11.4-0.2-15.8l-29.9-30.6c-4.3-4.4-11.3-4.5-15.5-0.2L131.1,247.9 c-2.2,2.2-3.2,5.2-3,8.1c-0.1,3,0.9,5.9,3,8.1l204.2,212.7c4.2,4.3,11.2,4.2,15.5-0.2l29.9-30.6c4.3-4.4,4.4-11.5,0.2-15.8 L213.7,256z"/>\n\t</svg>'},arrowRight:function(e){return'<svg fill="'+e+'" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 512 512" xml:space="preserve">\n\t\t<path d="M298.3,256L298.3,256L298.3,256L131.1,81.9c-4.2-4.3-4.1-11.4,0.2-15.8l29.9-30.6c4.3-4.4,11.3-4.5,15.5-0.2l204.2,212.7 c2.2,2.2,3.2,5.2,3,8.1c0.1,3-0.9,5.9-3,8.1L176.7,476.8c-4.2,4.3-11.2,4.2-15.5-0.2L131.3,446c-4.3-4.4-4.4-11.5-0.2-15.8 L298.3,256z"/>\n\t</svg>'},close:function(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="'+e+'" class="bi bi-arrow-left" viewBox="0 0 16 16">\n\t\t<path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"/>\n  \t</svg>'}},y=function(e){var t=e.fill,n=e.type,r=d(e,["fill","type"]),o=b[n];return a.createElement("span",p({dangerouslySetInnerHTML:{__html:o(t)}},r))};function w(e){var t=e.direction,r=e.icon,o=e.onClick,i=e.size,s=e.theme,c=d(e,["direction","icon","onClick","size","theme"]),u=n.StyleSheet.create(g(x,s));return a.createElement("button",p({type:"button",className:n.css(u.arrow,u["arrow__direction__"+t],i&&u["arrow__size__"+i]),onClick:o,onTouchEnd:o},c),a.createElement(y,{fill:!!s.arrow&&s.arrow.fill||l.arrow.fill,type:r}))}y.defaultProps={fill:"#fff"},w.defaultProps={size:"medium"};var x={arrow:{background:"none",border:"none",borderRadius:4,cursor:"pointer",outline:"none",padding:10,position:"absolute",top:"50%",WebkitTouchCallout:"none",userSelect:"none"},arrow__size__medium:{height:l.arrow.height,marginTop:l.arrow.height/-2,width:40,"@media (min-width: 768px)":{width:70}},arrow__size__small:{height:l.thumbnail.size,marginTop:l.thumbnail.size/-2,width:30,"@media (min-width: 500px)":{width:40}},arrow__direction__right:{right:l.container.gutter.horizontal},arrow__direction__left:{left:l.container.gutter.horizontal}},k=m(["\n    align-items: center;\n    background: ",";\n    box-sizing: border-box;\n    display: flex;\n    height: 100%;\n    justify-content: center;\n    left: 0;\n    padding-top: ","px;\n    padding-right: ","px;\n    padding-bottom: ","px;\n    padding-left: ","px;\n    position: fixed;\n    top: 0;\n    width: 100%;\n    z-index: ",";\n  "],["\n    align-items: center;\n    background: ",";\n    box-sizing: border-box;\n    display: flex;\n    height: 100%;\n    justify-content: center;\n    left: 0;\n    padding-top: ","px;\n    padding-right: ","px;\n    padding-bottom: ","px;\n    padding-left: ","px;\n    position: fixed;\n    top: 0;\n    width: 100%;\n    z-index: ",";\n  "]),C=r.div(k,function(e){return e.defaults.container.background},function(e){return e.defaults.container.gutter.vertical},function(e){return e.defaults.container.gutter.horizontal},function(e){return e.defaults.container.gutter.vertical},function(e){return e.defaults.container.gutter.horizontal},function(e){return e.defaults.container.zIndex});function I(e){n.StyleSheet.create(g(z,e.theme));return a.createElement(C,p({defaults:l,id:"viewerBackdrop"},e))}var z={container:{alignItems:"center",backdropColor:l.container.background,boxSizing:"border-box",display:"flex",height:"100%",justifyContent:"center",left:0,paddingTop:l.container.gutter.vertical,paddingRight:l.container.gutter.horizontal,paddingBottom:l.container.gutter.vertical,paddingLeft:l.container.gutter.horizontal,position:"fixed",top:0,width:"100%",zIndex:l.container.zIndex}},E=m(["\n    box-sizing: border-box;\n    color: ",";\n    cursor: auto;\n    display: flex;\n    justify-content: space-between;\n    left: 0;\n    line-height: 1.3;\n    padding-top: ","px;\n    padding-right: ","px;\n    padding-bottom: ","px;\n    padding-left: ","px;\n  "],["\n    box-sizing: border-box;\n    color: ",";\n    cursor: auto;\n    display: flex;\n    justify-content: space-between;\n    left: 0;\n    line-height: 1.3;\n    padding-top: ","px;\n    padding-right: ","px;\n    padding-bottom: ","px;\n    padding-left: ","px;\n  "]),S=m(["\n    color: ",";\n    font-size: ","px;\n    padding-left: 1em; // add a small gutter for the caption\n  "],["\n    color: ",";\n    font-size: ","px;\n    padding-left: 1em; // add a small gutter for the caption\n  "]);function _(e){var t=e.countCurr,n=e.countSeparator,o=e.countTotal,i=e.showCount;e.theme,d(e,["countCurr","countSeparator","countTotal","showCount","theme"]);if(!i)return null;var s=r.div(E,function(e){return e.defaults.footer.color},function(e){return e.defaults.footer.gutter.vertical},function(e){return e.defaults.footer.gutter.horizontal},function(e){return e.defaults.footer.gutter.vertical},function(e){return e.defaults.footer.gutter.horizontal}),c=r.div(S,function(e){return e.defaults.footer.count.color},function(e){return e.defaults.footer.count.fontSize}),u=i?a.createElement(c,{defaults:l},t,n,o):a.createElement("span",null);return a.createElement(s,{defaults:l},u)}l.footer.color,l.footer.gutter.vertical,l.footer.gutter.horizontal,l.footer.gutter.vertical,l.footer.gutter.horizontal,l.footer.count.color,l.footer.count.fontSize;function T(e){var t=e.caption,r=e.customControls,o=e.onClose,i=e.showCloseBtn,s=e.closeBtnTitle,c=e.theme,u=d(e,["caption","customControls","onClose","showCloseBtn","closeBtnTitle","theme"]),h=n.StyleSheet.create(g(P,c));return a.createElement("div",p({className:n.css(h.header)},u),!!i&&a.createElement("div",{className:n.css(h.titlediv)},a.createElement("button",{title:s,className:n.css(h.close),onClick:o},a.createElement(y,{fill:!!c.close&&c.close.fill||l.close.fill,type:"close"})),a.createElement("span",{className:n.css(h.title)},t)),r?a.createElement("div",{className:n.css(h.controls)},r):a.createElement("span",null))}var P={header:{display:"flex",height:l.header.height,position:"relative",width:"65vw"},controls:{position:"absolute",right:"0px"},titlediv:{display:"flex",alignItems:"center"},title:{verticalAlign:"middle",color:l.footer.count.color,display:"inline-block",fontFamily:l.header.font},close:{background:"none",border:"none",cursor:"pointer",outline:"none",position:"relative",top:0,verticalAlign:"bottom",zIndex:1,height:40,padding:10,width:40}};function L(e){var t=e.index,r=e.src,o=e.thumbnail,i=e.active,l=e.onClick,s=e.theme,c=o||r,u=n.StyleSheet.create(g(N,s));return a.createElement("div",{className:n.css(u.thumbnail,i&&u.thumbnail__active),onClick:function(e){e.preventDefault(),e.stopPropagation(),l(t)},style:{backgroundImage:'url("'+c+'")'}})}var N={thumbnail:{backgroundPosition:"center",backgroundSize:"cover",borderRadius:2,boxShadow:"inset 0 0 0 1px hsla(0, 0%, 100%, .2)",cursor:"pointer",display:"inline-block",height:l.thumbnail.size,margin:l.thumbnail.gutter,overflow:"hidden",width:l.thumbnail.size},thumbnail__active:{boxShadow:"inset 0 0 0 2px "+l.thumbnail.activeBorderColor}},O=n.StyleSheet.create({paginatedThumbnails:{bottom:l.container.gutter.vertical,height:l.thumbnail.size,padding:"0 50px",position:"absolute",textAlign:"center",whiteSpace:"nowrap",left:"50%",transform:"translateX(-50%)"}}),j={height:l.thumbnail.size+2*l.thumbnail.gutter,width:40},A=function(e){function t(e){c(this,t);var n=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hasCustomPage:!1},n.gotoPrev=n.gotoPrev.bind(n),n.gotoNext=n.gotoNext.bind(n),n}return h(t,e),u(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.currImg!==this.props.currImg&&this.setState({hasCustomPage:!1})}},{key:"getFirst",value:function(){var e=this.props,t=e.currImg,n=e.offset;return this.state.hasCustomPage?this.clampFirst(this.state.first):this.clampFirst(t-n)}},{key:"setFirst",value:function(e,t){var n=this.state.first;e&&(e.preventDefault(),e.stopPropagation()),n!==t&&this.setState({hasCustomPage:!0,first:t})}},{key:"gotoPrev",value:function(e){this.setFirst(e,this.getFirst()-this.props.offset)}},{key:"gotoNext",value:function(e){this.setFirst(e,this.getFirst()+this.props.offset)}},{key:"clampFirst",value:function(e){var t=this.props,n=t.imgs,r=2*t.offset+1;return e<0?0:e+r>n.length?n.length-r:e}},{key:"renderArrowPrev",value:function(e){var t=this.props.leftTitle;return this.getFirst()<=0?null:a.createElement(w,{theme:e,direction:"left",size:"small",icon:"arrowLeft",onClick:this.gotoPrev,style:j,title:t,type:"button"})}},{key:"renderArrowNext",value:function(e){var t=this.props,n=t.offset,r=t.imgs,o=t.rightTitle,i=2*n+1;return this.getFirst()+i>=r.length?null:a.createElement(w,{theme:e,direction:"right",size:"small",icon:"arrowRight",onClick:this.gotoNext,style:j,title:o,type:"button"})}},{key:"render",value:function(){var e=this.props,t=e.imgs,r=e.currImg,o=e.onClickThumbnail,i=e.offset,l=e.theme,s=2*i+1,c=[],u=0;return t.length<=s?c=t:(u=this.getFirst(),c=t.slice(u,u+s)),a.createElement("div",{className:n.css(O.paginatedThumbnails)},this.renderArrowPrev(l),c.map(function(e,t){return a.createElement(L,p({theme:l,key:u+t},e,{index:u+t,onClick:o,active:u+t===r}))}),this.renderArrowNext(l))}}]),t}(t.Component),B=function(e){var t=e.color,n=e.size;return{bouncingLoader:{display:"flex",justifyContent:"center"},child:{width:n,height:n,margin:3*n+"px "+.2*n+"px",background:t,borderRadius:"50%",animationName:function(e){return{"0%":{opacity:1,transform:"translateY(0)"},"100%":{opacity:.1,transform:"translateY(-"+e+"px)"}}}(n),animationDuration:".6s",animationDirection:"alternate",animationIterationCount:"infinite"},child2:{animationDelay:"0.2s"},child3:{animationDelay:"0.4s"}}};function F(e){var t=e.srcSet||e.srcset;return Array.isArray(t)?t.join():t}var D=a.createContext({theme:l,toggleTheme:function(e){}}),R=function(e){function n(e){c(this,n);var t=f(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.theme=g(l,t.props.theme),t.classes=o.StyleSheet.create(g(K,t.props.theme)),t.toggleTheme=function(e){t.setState(function(){return{theme:e}})},t.state={imgLoaded:!1,theme:t.theme,toggleTheme:t.toggleTheme},function(e){var t=this;e.forEach(function(e){return t[e]=t[e].bind(t)})}.call(t,["gotoNext","gotoPrev","closeBackdrop","handleKeyboardInput","handleImgLoaded"]),t}return h(n,e),u(n,[{key:"componentDidMount",value:function(){this.props.isOpen&&(this.props.enableKeyboardInput&&window.addEventListener("keydown",this.handleKeyboardInput),"number"==typeof this.props.currImg&&this.preloadImg(this.props.currImg,this.handleImgLoaded))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(v){if(e.preloadNextImg){var t=e.currImg+1,n=e.currImg-1;this.preloadImg(n),this.preloadImg(t)}if(this.props.currImg!==e.currImg||!this.props.isOpen&&e.isOpen){var r=this.preloadImgData(e.imgs[e.currImg],this.handleImgLoaded);r&&this.setState({imgLoaded:r.complete})}return!this.props.isOpen&&e.isOpen&&e.enableKeyboardInput&&window.addEventListener("keydown",this.handleKeyboardInput),!e.isOpen&&e.enableKeyboardInput&&window.removeEventListener("keydown",this.handleKeyboardInput),null}}},{key:"componentWillUnmount",value:function(){this.props.enableKeyboardInput&&window.removeEventListener("keydown",this.handleKeyboardInput)}},{key:"preloadImg",value:function(e,t){return this.preloadImgData(this.props.imgs[e],t)}},{key:"preloadImgData",value:function(e,t){if(e){var n=new Image,r=F(e);return n.onerror=t,n.onload=t,n.src=e.src,r&&(n.srcset=r),n}}},{key:"gotoNext",value:function(e){var t=this.props,n=t.currImg,r=t.imgs;this.state.imgLoaded&&n!==r.length-1&&(e&&(e.preventDefault(),e.stopPropagation()),this.props.onClickNext())}},{key:"gotoPrev",value:function(e){var t=this.props.currImg;this.state.imgLoaded&&0!==t&&(e&&(e.preventDefault(),e.stopPropagation()),this.props.onClickPrev())}},{key:"closeBackdrop",value:function(e){"viewerBackdrop"!==e.target.id&&"FIGURE"!==e.target.tagName||this.props.onClose()}},{key:"handleKeyboardInput",value:function(e){var t=e.keyCode;return 37===t||33===t||38===t?(this.gotoPrev(e),!0):39===t||34===t||40===t?(this.gotoNext(e),!0):(27===t||32===t)&&(this.props.onClose(),!0)}},{key:"handleImgLoaded",value:function(){this.setState({imgLoaded:!0})}},{key:"renderArrowPrev",value:function(e){return 0===this.props.currImg?null:a.createElement(w,{theme:e,direction:"left",icon:"arrowLeft",onClick:this.gotoPrev,title:this.props.leftArrowTitle,type:"button"})}},{key:"renderArrowNext",value:function(e){return this.props.currImg===this.props.imgs.length-1?null:a.createElement(w,{theme:e,direction:"right",icon:"arrowRight",onClick:this.gotoNext,title:this.props.rightArrowTitle,type:"button"})}},{key:"renderDialog",value:function(e){var n=this,r=this.props,l=r.backdropCloseable,s=r.isOpen,c=r.showThumbnails,u=r.width,p=this.state.imgLoaded;if(!s)return a.createElement("span",{key:"closed"});var h=c?this.theme.thumbnail.size+this.theme.container.gutter.vertical:0;return a.createElement(D.Consumer,null,function(r){var s=r.theme;r.toggleTheme;return s=e.theme,a.createElement(I,{theme:s,key:"open",onClick:l&&n.closeBackdrop,onTouchEnd:l&&n.closeBackdrop},a.createElement(t.Fragment,null,a.createElement("div",{className:o.css(n.classes.content),style:{marginBottom:h,maxWidth:u}},p&&n.renderHeader(s)," ",n.renderImgs(s),n.renderSpinner()," ",p&&n.renderFooter(s)),p&&n.renderThumbnails(s),p&&n.renderArrowPrev(s),p&&n.renderArrowNext(s),n.props.preventScroll&&a.createElement(i,null)))})}},{key:"renderImgs",value:function(e){var t=this.props,n=t.currImg,r=t.imgs,i=t.onClickImg,l=t.showThumbnails,s=this.state.imgLoaded;if(!r||!r.length)return null;var c=r[n],u=F(c),p=u?"100vw":null,h=l?e.thumbnail.size:0,d=e.header.height+e.footer.height+h+e.container.gutter.vertical+"px";return a.createElement("figure",{className:o.css(this.classes.figure)},a.createElement("img",{className:o.css(this.classes.img,s&&this.classes.imgLoaded),onClick:i,sizes:p,alt:c.alt,src:c.src,srcSet:u,style:{cursor:i?"pointer":"auto",maxHeight:"calc(100vh - "+d}}))}},{key:"renderThumbnails",value:function(e){var t=this.props,n=t.imgs,r=t.currImg,o=t.leftArrowTitle,i=t.rightArrowTitle,l=t.onClickThumbnail,s=t.showThumbnails,c=t.thumbnailOffset;return s?a.createElement(A,{theme:e,leftTitle:o,rightTitle:i,currImg:r,imgs:n,offset:c,onClickThumbnail:l}):null}},{key:"renderHeader",value:function(e){var t=this.props,n=t.imgs,r=t.currImg,o=t.closeBtnTitle,i=t.customControls,l=t.onClose,s=t.showCloseBtn;return a.createElement(T,{theme:e,customControls:i,onClose:l,caption:n[r].caption,showCloseBtn:s,closeBtnTitle:o})}},{key:"renderFooter",value:function(e){var t=this.props,n=t.currImg,r=t.imgs,o=t.imgCountSeparator,i=t.showImgCount;return r&&r.length?a.createElement(_,{theme:e,countCurr:n+1,countSeparator:o,countTotal:r.length,showCount:i}):null}},{key:"renderSpinner",value:function(){var e=this.props,t=e.spinner,n=e.spinnerDisabled,r=e.spinnerColor,i=e.spinnerSize,l=this.state.imgLoaded,s=t;return n?null:a.createElement("div",{className:o.css(this.classes.spinner,!l&&this.classes.spinnerActive)},a.createElement(s,{color:r,size:i}))}},{key:"render",value:function(){return a.createElement(D.Provider,{value:this.state},this.renderDialog(this.state))}}]),n}(t.Component);R.defaultProps={currImg:0,enableKeyboardInput:!0,imgCountSeparator:" / ",onClickShowNextImg:!0,preloadNextImg:!0,preventScroll:!0,showCloseBtn:!0,showImgCount:!0,spinnerDisabled:!1,spinner:function(e){var t=n.StyleSheet.create(B(e));return a.createElement("div",{className:n.css(t.bouncingLoader)},a.createElement("div",{className:n.css(t.child)}),a.createElement("div",{className:n.css(t.child,t.child2)}),a.createElement("div",{className:n.css(t.child,t.child3)}))},spinnerColor:"#fff",spinnerSize:50,theme:{},thumbnailOffset:2,width:1024};var K={content:{position:"relative"},figure:{margin:0},img:{display:"block",height:"auto",margin:"0 auto",maxWidth:"100%",WebkitTouchCallout:"none",userSelect:"none",opacity:0,transition:"opacity .3s"},imgLoaded:{opacity:1},spinner:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",opacity:0,transition:"opacity .3s",pointerEvents:"none"},spinnerActive:{opacity:1}};return R});
